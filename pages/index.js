import { useState } from "react";
import { motion } from "framer-motion";
import clsx from "clsx";
import Head from "next/head";
import Image from "next/image";
import styles from "@/styles/Home.module.css";
import { SearchInput } from "@/components/SearchInput";
import { Suggestions } from "@/components/Suggestions";

export default function Home() {
  const [showingResult, setShowingResult] = useState(false);
  const [question, setQuestion] = useState("");

  const handleSearch = (val) => {
    if (val) {
      setQuestion(val);
      setShowingResult(true);
    } else {
      setQuestion("");
      setShowingResult(false);
    }
  };

  return (
    <>
      <Head>
        <title>SmartChart</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={clsx(styles.main, showingResult && styles.withResult)}>
        <motion.div
          layout
          className={clsx(styles.content, showingResult && styles.withResult)}
        >
          <SearchInput
            onSearch={handleSearch}
            showingResult={showingResult}
            searchValue={question}
          />

          <Suggestions showingResult={showingResult} onSelect={handleSearch} />
        </motion.div>

        <footer className={styles.footer}>
          <a
            href="https://tidbcloud.com/?utm_source=smartchart&utm_medium=referral"
            target="_blank"
            rel="noopener noreferrer"
          >
            Powered by{" "}
            <Image
              src="/tidb.svg"
              alt="TiDB Cloud Logo"
              width={138}
              height={24}
              priority
            />
          </a>
        </footer>
      </main>
    </>
  );
}
